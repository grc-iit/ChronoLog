FROM ubuntu:22.04

# Install dependencies
RUN apt-get update && \
    DEBIAN_FRONTEND=noninteractive apt-get install -y \
    git g++ python3 curl build-essential unzip tar \
    libtool autoconf automake pkg-config jq lsof cmake

# Clone Spack
RUN git clone --branch v0.21.2 https://github.com/spack/spack.git /opt/spack && \
    echo "source /opt/spack/share/spack/setup-env.sh" >> /etc/bash.bashrc

# Setup Spack in PATH
ENV SPACK_ROOT=/opt/spack
ENV PATH=$SPACK_ROOT/bin:$PATH
SHELL ["/bin/bash", "-c"]

WORKDIR /workspace
